# HDF5压缩算法调研与评估项目

## 📋 项目概述

本项目是一个综合性的HDF5压缩算法调研与评估系统，旨在评估候选人对现代C++开发、HDF5压缩过滤器使用、HDF5文件格式等技术的掌握程度。

**重要说明**: 本项目不要求自己编写压缩算法，而是调用HDF5已有的压缩过滤器（如GZIP、LZ4、ZSTD、Blosc等）进行数据压缩，找出最合适的压缩方案，压缩比至少达到1.5:1。

**关于HDF5文件的重要说明**: 
- 提供的HDF5文件由于超过100MB限制，已拆分为5个部分（每个小于40MB）
- **文件合并**: 候选人需要先运行 `./merge_hdf5.sh` 将拆分文件合并为完整文件后再进行测试
- **压缩状态**: 原始HDF5文件已经使用了ONT的VBZ压缩算法进行存储
- **体积变化**: 读取后重新保存时，如果使用不同的压缩设置或未压缩格式，文件体积增大是正常现象
- **评估基准**: 评估时应以**重新保存后的文件体积**作为基准进行压缩比计算
- **文件查看**: 可以使用[HDFView](https://www.hdfgroup.org/download-hdfview/)工具查看合并后的HDF5文件结构和内容

**请仔细阅读本README，这是候选人需要完成的完整项目要求。**

## 🎯 项目目标

1. **HDF5文件处理**: 运行 `./merge_hdf5.sh` 合并拆分文件，读取完整文件并提取其中的所有数据，作为HDF5压缩写入测试的数据源
2. **性能对比**: 测试单个HDF5文件保存时间(ms)、压缩比(相对于未压缩版本)，选出适合int16信号数据的最优压缩方案
3. **测试框架**: 使用GoogleTest编写单元测试（必须）和集成测试（如有必要）
4. **结果输出**: 生成表格形式的测试结果报告

## 🏗️ 技术栈

- **C++17**: 主要开发语言
- **CMake**: 构建系统
- **vcpkg**: 推荐的包管理器（也可使用其他包管理工具）
- **HDF5**: 数据存储格式
- **HDFView**: 可选的HDF5文件查看工具，用于可视化文件结构和内容
- **GoogleTest**: 单元测试框架
- **Python**: 可选，用于补充额外的测试和分析脚本

## 📁 项目结构

**项目结构建议**: 请根据个人最佳实践组织项目结构，以下仅为参考示例：

```
hdf5-compression-research/
├── README.md                 # 项目说明文档
├── CMakeLists.txt           # CMake构建配置
├── vcpkg.json              # vcpkg依赖配置（如使用vcpkg）
├── .gitignore              # Git忽略文件
├── src/                    # C++源代码目录
├── tests/                  # GoogleTest测试用例
├── docs/                   # 技术文档
├── scripts/                # 构建和测试脚本
├── python/                 # Python补充脚本（可选）
├── data/                   # 测试数据目录
└── results/                # 测试结果输出目录
```

**组织原则**:
- 保持结构清晰，便于维护和扩展
- 遵循C++项目的最佳实践
- 确保构建系统配置正确
- 合理分离源代码、测试、文档和脚本

## 🚀 快速开始

### 环境要求
- Ubuntu 22.04+ | CMake 3.20+ | C++17编译器 | Git
- Python 3.8+（可选，用于补充测试）


## 📊 评估标准

### 技术能力评估维度

1. **C++开发能力**
   - HDF5文件读取和写入
   - 压缩过滤器调用和配置
   - 性能测试和结果输出

2. **测试能力**
   - GoogleTest单元测试编写
   - 集成测试设计
   - 测试覆盖率

3. **系统设计能力**
   - 模块化设计
   - 接口设计
   - 可扩展性

4. **文档质量**
   - **环境配置文档**（必须，确保项目可复现）
   - 技术文档
   - 使用说明
   - 代码注释

## 🎯 具体任务要求

### 阶段1: 基础环境搭建

1. **环境配置**（**必须完成**）
   - 配置包管理器（推荐vcpkg，也可使用其他工具）
   - 安装HDF5、GoogleTest等依赖
   - 安装所需压缩过滤器插件（VBZ、Blosc2等）
   - 配置CMake构建系统
   - **编写完整的环境配置文档**（详见下方要求）

2. **环境配置文档要求**（**必须提供**）
   
   候选人**必须**在项目中提供完整的环境配置文档（如 `docs/ENVIRONMENT_SETUP.md` 或 `INSTALL.md`），包含以下内容：
   
   - **依赖列表**: 完整的依赖库列表及版本号（HDF5、GoogleTest、压缩过滤器插件等）
   - **安装步骤**: 详细的安装命令和步骤，包括：
     - 系统基础依赖安装
     - HDF5库安装（说明使用的方式：系统包管理器/vcpkg/源码编译）
     - 压缩过滤器插件安装（VBZ、Blosc2等）
     - GoogleTest安装
   - **环境变量配置**: 所有需要设置的环境变量及配置方法
   - **验证步骤**: 如何验证各依赖安装成功的命令
   - **常见问题**: 可能遇到的问题及解决方案
   - **自动化脚本**: 提供自动化安装脚本（如 `scripts/setup.sh` 或 `scripts/setup.bat`），实现一键环境配置（加分项）
   - **可复现性**: 确保他人能够根据文档完整复现环境
   
   **评估标准**: 环境配置文档的完整性和可复现性是重要的评估指标。

3. **项目结构设计**
   - 根据个人最佳实践设计项目结构
   - 设计模块化的代码结构
   - 定义清晰的接口和抽象
   - 配置构建系统（CMake等）

### 阶段2: HDF5压缩测试

1. **文件处理**
   - **文件合并**: 运行 `./merge_hdf5.sh` 将拆分文件合并为完整文件
   - **数据读取**: 读取合并后的完整HDF5文件
   - **格式测试**: 写入不压缩格式和各种压缩格式
   - **性能测试**: 测试单个文件保存时间(ms)和压缩比(相对于未压缩版本)

2. **压缩方案对比**
   - 测试GZIP、LZ4、ZSTD、Blosc等压缩过滤器
   - 配置不同压缩参数和级别
   - 选出适合int16信号数据的最优方案

3. **结果输出**
   - 生成表格形式的测试结果报告
   - 性能指标收集和分析

### 阶段3: 测试和文档

1. **GoogleTest测试**
   - 编写单元测试
   - 编写集成测试
   - 确保测试覆盖率

2. **Python补充测试**（可选）
   - 使用Python脚本进行额外的性能分析
   - 数据可视化（压缩比对比图表、性能趋势图等）
   - 自动化测试脚本
   - 结果数据后处理和分析

3. **文档编写**
   - 编写技术文档
   - 编写使用指南

## 📈 评估指标

**代码质量**: 可读性、错误处理、性能优化  
**功能完整性**: HDF5文件处理、压缩测试（保存时间+压缩比）、结果输出  
**测试质量**: GoogleTest使用、测试覆盖率、集成测试

## 🏆 加分项

**创新性**: 自定义配置、性能优化、创新测试方法  
**工程化**: CI/CD、监控日志  
**扩展性**: 插件化、配置化、模块化设计  
**Python增强**: 数据可视化、自动化分析脚本、结果图表生成  
**跨平台支持**: 同时支持Ubuntu 22.04+、Windows 11、macOS等主流操作系统

## 📞 提交要求

### GitHub仓库
- **仓库名**: `hdf5-compression-research-[your-name]`
- **仓库地址**: 建立仓库后，请将仓库地址发送至 `zenghui.liu@polyseq.com`
- **仓库设置**: 确保GitHub仓库公开，便于评估
- **提交建议**: 建议每天有代码提交，提供合适的commit注释信息
- **提交内容**: 
  - 完整源代码
  - 构建脚本（CMakeLists.txt等）
  - **环境配置文档**（必须，如 `docs/ENVIRONMENT_SETUP.md`）
  - GoogleTest测试用例
  - Python补充脚本（可选）
  - 技术文档和使用说明

**重要提醒**: 
1. 独立完成，避免抄袭
2. **允许使用AI辅助编程**，但代码不能由他人代写，需在技术文档中说明与AI的交互过程
3. **环境配置文档**: **必须**提供完整的环境配置文档，确保项目可复现（详见"阶段1"要求）
4. **面试环节**: 如果达到要求，会有视频面试讲解项目
5. 确保GitHub仓库公开，便于评估
6. **关于文件处理**: HDF5文件已拆分为5个部分（每个小于40MB），需要先运行 `./merge_hdf5.sh` 合并再测试；原始文件已使用ONT的VBZ压缩，重新保存后体积变化属正常现象，请以重新保存后的文件为基准进行压缩比计算

## 📚 补充资料

**说明**: 以下列出的所有资源均为**网上公开可用的开源工具和文档**，候选人可以自由访问和使用。

### 官方文档和资源

- **HDF Group官网**: [https://www.hdfgroup.org/](https://www.hdfgroup.org/)
  - HDF5官方文档、教程、API参考
  - 压缩过滤器使用指南和最佳实践
  - 社区支持和帮助资源

- **ONT VBZ压缩插件**: [https://github.com/nanoporetech/vbz_compression](https://github.com/nanoporetech/vbz_compression)
  - Oxford Nanopore Technologies开发的VBZ压缩插件
  - 专门针对纳米孔测序信号数据优化
  - 包含安装说明、使用示例和性能基准

- **其他HDF5压缩过滤器插件**
  - 请自行搜索HDF5压缩过滤器插件，包括但不限于：
    - **Blosc2**: 新一代Blosc框架，提供更强大的压缩能力和性能（**强烈建议测试**）
    - Blosc压缩过滤器（适合科学数据）
    - LZ4压缩过滤器（快速压缩）
    - ZSTD压缩过滤器（高压缩比）
    - Bitshuffle压缩过滤器（适合整数数据）
    - 其他第三方压缩过滤器插件

### 测试要求详细说明

**重要说明**: 本文档中列出的所有压缩过滤器（filter）均为**网上公开可用的开源资源**，候选人可以自由获取和使用。所有依赖库和工具都有公开的文档和安装指南，候选人需要自行查找和配置。

#### 压缩过滤器测试覆盖

**测试范围**: 候选人需要**尽量覆盖所有适合测序信号数据的HDF5压缩过滤器**，包括但不限于：

1. **标准HDF5内置过滤器**
   - GZIP (H5Z_FILTER_DEFLATE)
   - SZIP (H5Z_FILTER_SZIP)
   - SHUFFLE (H5Z_FILTER_SHUFFLE) - 通常与其他过滤器组合使用

2. **第三方压缩过滤器**
   - **VBZ**: ONT专为纳米孔信号数据优化的压缩算法
   - **Blosc2**: 新一代Blosc框架，提供多种压缩算法和预处理器组合（**强烈建议测试**）
   - **Blosc**: 适合科学数据的块压缩算法（Blosc2的前身）
   - **LZ4**: 快速压缩算法，适合实时场景
   - **ZSTD**: 平衡压缩比和速度的现代压缩算法
   - **Bitshuffle**: 专门针对整数数据的压缩过滤器
   - 其他适合整数/信号数据的压缩过滤器

#### 参数配置测试

**参数组合测试**: 对于每个支持的压缩过滤器，需要测试**不同参数配置下的性能表现**：

1. **压缩级别参数**
   - 对于支持压缩级别的过滤器（如GZIP、ZSTD），测试多个压缩级别（如1-9）
   - 对于不支持压缩级别的过滤器，测试其可配置参数组合

2. **数据预处理选项**
   - 测试Shuffle过滤器与压缩过滤器的组合使用
   - 测试不同块大小（chunk size）对压缩效果的影响

3. **性能指标记录**
   - **压缩比**: 相对于未压缩版本的压缩比（压缩后大小/未压缩大小）
   - **压缩时间**: 单个文件保存时间（毫秒）

#### 结果输出要求

**测试结果表格**: 必须生成包含以下信息的详细测试结果表格：

| 压缩过滤器 | 参数配置 | 压缩级别 | 压缩比 | 压缩时间(ms) | 文件大小(MB) | 备注 |
|-----------|---------|---------|--------|-------------|-------------|------|
| None | - | - | 1.0 | XX | XX | 基准（未压缩） |
| GZIP | shuffle=1 | 1 | X.XX | XX | XX | - |
| GZIP | shuffle=1 | 6 | X.XX | XX | XX | - |
| GZIP | shuffle=1 | 9 | X.XX | XX | XX | - |
| VBZ | ... | ... | X.XX | XX | XX | - |
| ... | ... | ... | ... | ... | ... | ... |

**最优方案选择**: 根据测试结果，综合考虑压缩比和压缩时间，选出最适合int16信号数据的压缩算法和参数配置，并在报告中说明选择理由。

#### 测试建议

1. **自动化测试**: 建议编写自动化测试脚本，批量测试所有压缩过滤器和参数组合
2. **多次测试**: 对每个配置进行多次测试，取平均值以提高结果可靠性
3. **内存监控**: 可选，监控不同压缩算法对内存使用的影响
4. **可视化分析**: 可选，使用Python生成压缩比和性能对比图表

